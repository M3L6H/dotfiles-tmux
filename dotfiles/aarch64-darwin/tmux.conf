set -g @plugin 'tmux-plugins/tpm'

set  -g default-terminal "tmux-256color"
set  -g base-index      1
setw -g pane-base-index 1





set -g status-keys vi
set -g mode-keys   vi



# rebind main key: M-Space
unbind C-b
set -g prefix M-Space
bind -n -N "Send the prefix key through to the application" \
  M-Space send-prefix




set  -g mouse             on
set  -g focus-events      off
setw -g aggressive-resize off
setw -g clock-mode-style  12
set  -s escape-time       500
set  -g history-limit     2000

# ============================================= #
# Load plugins with Home Manager                #
# --------------------------------------------- #

# tmuxplugin-sessionx
# ---------------------
set -g @sessionx-bind "M-o"
set -g @sessionx-prefix off
set -g @sessionx-bind-tmuxinator-list "ctrl-t"

set -g @sessionx-tmuxinator-mode "on"


set -g @plugin "omerxx/tmux-sessionx"


# tmuxplugin-tmux-fingers
# ---------------------
set -g @fingers-pattern-1 "'(?<match>[^']+)'|\"(?<match>[^\"]+)\""
set -g @fingers-pattern-2 '^(󰚩  |❮ )(?<match>.{2,})'

set -g @fingers-hint-style "fg=magenta,bold,underscore"
set -g @fingers-highlight-style "fg=green"
set -g @fingers-selected-highlight-style "fg=blue"
set -g @fingers-backdrop-style "fg=yellow,dim"

set -g @plugin "tmux-plugins/tmux-tmux-fingers"


# tmuxplugin-sensible
# ---------------------

set -g @plugin "tmux-plugins/tmux-sensible"


# tmuxplugin-vim-tmux-navigator
# ---------------------

set -g @plugin "christoomey/vim-tmux-navigator"


# tmuxplugin-yank
# ---------------------

set -g @plugin "tmux-plugins/tmux-yank"

# ============================================= #

# Enter copy mode with Alt-v
bind-key -n 'M-v' run-shell $HOME/.local/bin/line-numbers.sh

# Shift-Alt- vim keys to switch windows
bind -n M-H previous-window
bind -n M-L next-window

# Reload tmux with PREFIX+r
bind r source-file ~/.config/tmux/tmux.conf

# Disable confirmation for closing pane
bind x kill-pane

# Close all panes except current
bind X confirm-before -p "close all panes except current? (y/n)" 'kill-pane -a'

# Kill session
bind Q confirm-before -p "kill-session #S? (y/n)" kill-session

# Quick window jumping
bind f select-window -t 1
bind d select-window -t 2
bind s select-window -t 3
bind a select-window -t 4

# Proper vim select
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'C-v' send -X rectangle-toggle

# Open panes in current directory
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# Unbind time
unbind t

# Increase scrollback buffer size
set-option -g history-limit 100000

# Disable detatch on destroy so we can easily close all tmux sessions
set-option -g detach-on-destroy off

# No auto renaming
set-option -g allow-rename off

# Status bar
set -g @ACCENT_COL "#737c73"
set -g @ACTIVE_BORDER_COL "fg=#a292a3"
set -g @ALERT_COL "#c4746e"
set -g @BG_BAR_COL "#282727"
set -g @BG_PANE_COL "#1D1C19"
set -g @INACTIVE_BORDER_COL "#625e5a"
set -g @SELECTION_COL "#393836"
set -g @TEXT_COL "#c8c093"

set -g @ICON_PD " "
set -g @LEFT_SEP ""
set -g @RIGHT_SEP ""

# Border colors
set-option -g pane-active-border-style "fg=#{@ACTIVE_BORDER_COL}"
set-option -g pane-border-style "fg=#{@INACTIVE_BORDER_COL}"

# Message style
set-option -g message-style "bg=#{@BG_BAR_COL},fg=#{@TEXT_COL}"

# Prompt cursor colour
set-option -g prompt-cursor-colour "#737c73"

# Status bar
set-option -g status-position top
set-option -g status-left-length 24
set-option -g status-left "#{@ICON_PD}#{?client_prefix,#[fg=#{@ALERT_COL}],#[fg=#{@ACCENT_COL}]}#[bg=default]#{@LEFT_SEP}#{?client_prefix,#[fg=#{@BG_PANE_COL}],#[fg=#{@BG_PANE_COL}]}#{?client_prefix,#[bg=#{@ALERT_COL}],#[bg=#{@ACCENT_COL}]}󱚝  #{=16:session_name}#{?client_prefix,#[fg=#{@ALERT_COL}],#[fg=#{@ACCENT_COL}]}#[bg=default]#{@RIGHT_SEP}#{@ICON_PD}"
set-option -g status-right ""

# Transparent status background
set-option -g status-style bg=default
set-window-option -g window-status-separator ""
set-window-option -g window-status-current-format "#[fg=#{@SELECTION_COL},bg=default]#{@LEFT_SEP}#[fg=#{@TEXT_COL},bg=#{@SELECTION_COL}]#I #W#[fg=#{@SELECTION_COL},bg=default]#{@RIGHT_SEP}"
set-window-option -g window-status-format "#[fg=#{@TEXT_COL},bg=default] #I #W "
set-window-option -g window-status-activity-style "bold"
set-window-option -g window-status-bell-style "bold"

set -g visual-activity off
set -g visual-bell off
set -g visual-silence on
run '~/.tmux/plugins/tpm/tpm'
